apiVersion: kuttl.dev/v1beta1
kind: TestStep
timeout: 30
delete:
- apiVersion: v1
  kind: Pod
  name: materialized
# Assert that everything has been cleaned up
commands:
- script: >-
    kubectl -n $NAMESPACE get eips -ojson
    | jq -e '.items | length'
- script: >-
    kubectl exec -n $NAMESPACE commander --
    env AWS_ACCESS_KEY_ID=a AWS_SECRET_ACCESS_KEY=b AWS_REGION=me-south-1
    aws --endpoint-url=http://localstack.default:4566 ec2 describe-addresses
    | jq -e '.Addresses[] | length'
